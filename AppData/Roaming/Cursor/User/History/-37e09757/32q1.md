# Quick Fix Guide for Google Sheets Integration

## If data is not appearing in your spreadsheet after completing a quiz:

### Step 1: Check Browser Console
1. Open your quiz app
2. Press **F12** to open Developer Tools
3. Go to the **Console** tab
4. Complete a quiz
5. Look for these messages:
   - ðŸ”„ Starting Google Sheets export...
   - ðŸ“¤ Sending request...
   - ðŸ“¥ Response status...
   - âœ… Result added to Google Sheets successfully
   - âŒ Any error messages

### Step 2: Test the Connection
1. Open your quiz app
2. Press **F12** to open Developer Tools
3. Go to the **Console** tab
4. Type: `window.testGoogleSheetsConnection()`
5. Press Enter
6. Check the console for results
7. Check your Google Spreadsheet for a new "Test Quiz" sheet

### Step 3: Verify Google Apps Script Setup
1. Open your Google Spreadsheet: https://docs.google.com/spreadsheets/d/14X5Lh_ezbBTv-cmZN20WX8VL-wG5QXfGtUUEm5Kaf8g/edit
2. Go to **Extensions** > **Apps Script**
3. Make sure the code from `GOOGLE_APPS_SCRIPT_FALLBACK.js` is pasted
4. Click **Deploy** > **Manage deployments**
5. Make sure you have a deployment with:
   - Type: **Web app**
   - Execute as: **Me**
   - Who has access: **Anyone**
6. If you need to update, click the **pencil icon** to edit, then **Deploy**

### Step 4: Check Apps Script Execution Logs
1. In Google Apps Script editor, click **Executions** (clock icon on left)
2. Look for recent executions
3. Click on any failed executions to see error messages
4. Common errors:
   - "Permission denied" â†’ Make sure the script has access to the spreadsheet
   - "Invalid action" â†’ Check that the request format is correct
   - "Sheet not found" â†’ The spreadsheet ID might be wrong

### Step 5: Verify the URL in Code
1. Open `src/utils/googleSheets.js`
2. Check that `GOOGLE_APPS_SCRIPT_URL` matches your deployed Web App URL
3. The URL should look like: `https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec`

### Step 6: Common Issues and Solutions

**Issue: "Failed to fetch" or CORS error**
- Solution: Make sure your Apps Script is deployed with "Anyone" access
- Redeploy the Apps Script if needed

**Issue: "Network error"**
- Solution: Check your internet connection
- Try the test function: `window.testGoogleSheetsConnection()`

**Issue: No errors but no data in spreadsheet**
- Solution: Check Apps Script execution logs (Step 4)
- The script might be running but failing silently

**Issue: "Invalid action" error**
- Solution: Make sure you're using the latest code from `GOOGLE_APPS_SCRIPT_FALLBACK.js`
- Redeploy the Apps Script

### Step 7: Manual Test
1. Open your Google Spreadsheet
2. Manually create a test sheet named "Test Quiz"
3. Complete a quiz and see if data appears in that sheet
4. If it does, the issue is with sheet creation
5. If it doesn't, the issue is with data writing

## Still Not Working?

1. **Check the browser console** for specific error messages
2. **Check Apps Script execution logs** for server-side errors
3. **Verify the Apps Script URL** is correct in `src/utils/googleSheets.js`
4. **Redeploy the Apps Script** with the latest code
5. **Try the test function**: `window.testGoogleSheetsConnection()`

## Need More Help?

Share the following information:
- Browser console errors (screenshot or copy/paste)
- Apps Script execution logs (screenshot or copy/paste)
- The exact error message you see
- Whether the test function works or not

