# Complete Prompt for Cursor - Participant App Integration

Copy and paste this ENTIRE prompt to Cursor in your participant app project:

---

## ğŸ¯ TASK: Connect Participant App to Admin App Database & Implement Code Entry

I need to connect my participant app to the same Supabase database as my admin app and change from link-based access to code-based access.

### ğŸ“‹ REQUIREMENTS:

1. **Update Supabase Configuration**
   - Replace current Supabase credentials with these:
     - `VITE_SUPABASE_URL` = `https://tqsejmzmpaltnbvqmqor.supabase.co`
     - `VITE_SUPABASE_ANON_KEY` = `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRxc2VqbXptcGFsdG5idnFtcW9yIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI1NzE5MTYsImV4cCI6MjA3ODE0NzkxNn0.7-fpBTuUH1JdKBMcD4kvIW0v8yPJ5R8W98-ef6cpQwg`
   - Update in: `.env`, `.env.local`, or `supabaseConfig.js` (wherever Supabase is configured)

2. **Replace Link Input with Code Input**
   - Remove any URL/link input fields
   - Add a code input field (text input, uppercase, max 10 characters)
   - Design: Large, centered, monospace font, wide letter spacing
   - Placeholder: "Enter quiz code (e.g., ABC123)"

3. **Implement Code-Based Quiz Loading**
   - When participant enters code and submits:
     - Query Supabase: `supabase.from("quizzes").select("*").eq("share_code", code.toUpperCase().trim()).single()`
     - Check if quiz exists and is published: `quiz.status === "published"` OR `quiz.is_published === true`
     - If found and published: Load the quiz and show it
     - If not found: Show error "Quiz code not found. Please check the code and try again."
     - If found but not published: Show error "This quiz is not available yet."

4. **Error Handling**
   - Handle case-insensitive codes (convert to uppercase)
   - Remove spaces from input
   - Show clear error messages
   - Handle network errors gracefully

5. **UI/UX Requirements**
   - Code input should be prominent and easy to use
   - Auto-uppercase as user types
   - Large "Start Quiz" or "Access Quiz" button
   - Loading state while querying
   - Clear error messages

### ğŸ”§ IMPLEMENTATION DETAILS:

**Code Input Component:**
```jsx
// Example structure (adapt to your app's style)
const [quizCode, setQuizCode] = useState("");
const [loading, setLoading] = useState(false);
const [error, setError] = useState("");
const [quiz, setQuiz] = useState(null);

const handleCodeSubmit = async (e) => {
  e.preventDefault();
  const cleanCode = quizCode.trim().toUpperCase().replace(/\s/g, "");
  
  if (!cleanCode) {
    setError("Please enter a quiz code");
    return;
  }
  
  setLoading(true);
  setError("");
  
  try {
    const { data: quizData, error: quizError } = await supabase
      .from("quizzes")
      .select("*")
      .eq("share_code", cleanCode)
      .single();
    
    if (quizError || !quizData) {
      throw new Error("Quiz code not found. Please check the code and try again.");
    }
    
    if (quizData.status !== "published" && !quizData.is_published) {
      throw new Error("This quiz is not available yet. Please contact the administrator.");
    }
    
    // Quiz found and published - proceed to load quiz
    setQuiz(quizData);
    // Navigate to quiz or load quiz questions
  } catch (err) {
    setError(err.message || "Failed to load quiz");
  } finally {
    setLoading(false);
  }
};
```

**Database Schema:**
- Table: `quizzes`
- Column for code: `share_code` (TEXT)
- Column for status: `status` (TEXT, values: "draft" or "published")
- Also check: `is_published` (BOOLEAN) as fallback

**Query Pattern:**
```javascript
// Primary query
const { data, error } = await supabase
  .from("quizzes")
  .select("*")
  .eq("share_code", "ABC123")  // The code entered
  .single();

// Then check status
if (data && (data.status === "published" || data.is_published)) {
  // Load quiz
}
```

### âœ… CHECKLIST:

- [ ] Update Supabase URL and anon key in config file
- [ ] Replace link input with code input field
- [ ] Implement code submission handler
- [ ] Query quizzes by `share_code` (not by ID from URL)
- [ ] Check quiz is published before allowing access
- [ ] Handle uppercase/lowercase codes (normalize to uppercase)
- [ ] Show loading state during query
- [ ] Display clear error messages
- [ ] Test with a real code from admin app
- [ ] Remove any old URL-based quiz loading logic

### ğŸ¨ UI SUGGESTIONS:

**Code Input Design:**
- Large input field (text-2xl or larger)
- Centered on page
- Monospace font (font-mono)
- Wide letter spacing (tracking-wider)
- Uppercase transformation
- Clear "Enter Code" label
- Big "Start Quiz" button below

**Example Layout:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Enter Quiz Code            â”‚
â”‚                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚   ABC123          â”‚    â”‚  (large, centered, uppercase)
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â”‚
â”‚   [   Start Quiz   ]         â”‚
â”‚                              â”‚
â”‚   {Error message if any}     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸš¨ IMPORTANT NOTES:

1. **Same Database**: Both apps now use the same Supabase project
2. **Code Format**: Codes are 6-character uppercase (e.g., "ABC123")
3. **Published Only**: Only show quizzes where `status = "published"`
4. **No URL Parsing**: Don't read quiz ID from URL anymore - use code only
5. **Error Messages**: Be user-friendly and clear

### ğŸ” TESTING:

After implementation:
1. Get a quiz code from admin app (click "Get Link" on a published quiz)
2. Enter that code in participant app
3. Quiz should load successfully
4. Test with invalid code - should show error
5. Test with unpublished quiz code - should show "not available" message

---

**START IMPLEMENTING NOW. Update Supabase config first, then replace link input with code input, then implement the query logic.**

